<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ladyfish">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ladyfish</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/07/closure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/07/closure/" class="post-title-link" itemprop="url">模块与闭包</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-07 22:57:08" itemprop="dateCreated datePublished" datetime="2024-03-07T22:57:08+08:00">2024-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-08 11:28:38" itemprop="dateModified" datetime="2024-03-08T11:28:38+08:00">2024-03-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近重新翻读《你不知道的JavaScript》有感，进行系列记录，本文适合已经对闭包和模块有些许理解的同学阅读~</p>
<p>下面复习一下闭包</p>
<p>闭包的定义：当函数可以记住并访问所在的词法作用域时，就产生了闭包；闭包使得函数即使是在当前词法作用域之外执行也可以继续访问定义时的词法作用域。</p>
<h4 id="1-探讨模块与闭包之间的关系"><a href="#1-探讨模块与闭包之间的关系" class="headerlink" title="1.探讨模块与闭包之间的关系"></a>1.探讨模块与闭包之间的关系</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CoolModule</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> something = <span class="string">&quot;cool&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> another = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(something);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">doAnother</span></span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(another.join(<span class="string">&#x27;!&#x27;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">doSomething</span>:doSomething,</span><br><span class="line">          <span class="attr">doAnother</span>:doAnother</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>观察以上代码我们可以发现：</p>
<ol>
<li>CoolModule()只是一个函数，必须调用才能创建一个模块实例，如果不进行调用，内部作用域和闭包都无法被创建</li>
<li>CoolModule()返回一个对象，该对象含有对内部函数而不是内部数据变量的引用，内部数据变量保持隐藏且私有的状态，我们可以把这个返回的对象看作本质上是模块的公共API</li>
<li>doSomething和doAnother函数具有涵盖模块实例内部作用域的闭包</li>
</ol>
<p>综上所述，模块模式需要两个条件：</p>
<ol>
<li>必须要有外部的封闭函数，该函数至少被调用一次（每次调用都会创建一个新的模块实例）</li>
<li>封闭函数必须返回至少一个内部函数，这样内部函数才能在私有作用域中形成闭包，并且可以访问或者修改私有的状态</li>
</ol>
<h4 id="2-现代模块机制"><a href="#2-现代模块机制" class="headerlink" title="2.现代模块机制"></a>2.现代模块机制</h4><p>将上述的模块定义封装进一个友好API里，代码很优雅，我觉得很值得学习</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyModules = (<span class="function"><span class="keyword">function</span> <span class="title">Manager</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> modules = &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">define</span>(<span class="params">name, deps, impl</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; deps.length; i++) &#123;</span><br><span class="line">              <span class="comment">//遍历依赖队列，使用模块中的实际依赖进行重新赋值</span></span><br><span class="line">            deps[i] = modules[deps[i]]</span><br><span class="line">          &#125;</span><br><span class="line">            <span class="comment">//调用函数，并且使用依赖</span></span><br><span class="line">          modules[name] = impl.apply(impl, deps)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> modules[name]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">define</span>: define,</span><br><span class="line">          <span class="attr">get</span>: get,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)()</span><br><span class="line">      MyModules.define(<span class="string">&#x27;bar&#x27;</span>, [], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">who</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&#x27;helloooooo&#x27;</span> + who</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">hello</span>: hello &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      MyModules.define(<span class="string">&#x27;foo&#x27;</span>, [bar], <span class="function"><span class="keyword">function</span> (<span class="params">bar</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> hungry = <span class="string">&#x27;hipoo&#x27;</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">awesome</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(bar.hello(hungry).toUpperCase())</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">awesome</span>: awesome,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> bar = MyModules.get(<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line">      <span class="keyword">var</span> foo = MyModules.get(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(bar.hello(<span class="string">&#x27;hipoo&#x27;</span>))</span><br><span class="line">      foo.awesome()</span><br></pre></td></tr></table></figure>

<p>直接看上面的代码可能会有点难以理解，下面我搭配debug跟大家一起看看~</p>
<p><img src="/image/image-20240308112101523.png" alt="image-20240308112101523"></p>
<p>从上图可以看到调用了get函数同时也持有了get函数对原始定义作用域的引用（可以看到私有的变量modules及我们添加在上面的bar和foo）这就是闭包的效果，同时暴露公共API（<code>define</code>和<code>get</code>）得以对隐藏且私有的内部数据变量进行访问或修改。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/03/virtualList/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/03/virtualList/" class="post-title-link" itemprop="url">不是，是谁还在傻傻遍历生成成千上万个DOM？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-03-03 22:39:39 / Modified: 22:43:31" itemprop="dateCreated datePublished" datetime="2024-03-03T22:39:39+08:00">2024-03-03</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>虚拟列表赶紧用起来，轻轻松松解决超多重复DOM节点造成的卡顿~</p>
<p>以下有三种不同级别的虚拟列表，分别针对生成的重复DOM节点是固定高度、不同高度和动态变化高度~</p>
<h3 id="1-基础段位：固定高度"><a href="#1-基础段位：固定高度" class="headerlink" title="1.基础段位：固定高度"></a>1.基础段位：固定高度</h3><p><img src="/image/tutieshi_640x594_13s.gif" alt="tutieshi_640x594_13s"></p>
<p>虚拟列表的原理其实就是以下几条：</p>
<p>①一个外层盒子提供滚动事件</p>
<p>②外层盒子中装的第一个是platform，一个空盒子，这个空盒子的高度是列表如果真实渲染应该有的高度，作用是为了撑开外层盒子，提供滚动条</p>
<p>②外层盒子中装的第二个是展示列表盒子，这个盒子中放置所有现在应该出现在页面上的列表项和前后缓冲区。该盒子采用绝对定位，top值根据滚动位置实时改变，让展示列表不论怎么滚动一直出现在页面上</p>
<p>④酌情给一些在页面展示之前之后的缓冲区，防止因为用户滚动过快而造成的空白</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;virtualBox&quot; @scroll=&quot;scrollEvent&quot; ref=&quot;virtualBox&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;platform&quot; :style=&quot;&#123; height: platformHeight + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;trueBox&quot; :style=&quot;&#123; top: top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">        &lt;div v-for=&quot;(key, value) in showData&quot; class=&quot;itemBox&quot; ref=&quot;itemBox&quot;&gt;</span><br><span class="line">          &lt;button&gt;看起来&#123;&#123; key &#125;&#125; 其实我是&#123;&#123; value &#125;&#125;&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;WebFront&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      listData: [],//真实列表Data</span><br><span class="line">      count: 100,//真实列表项的个数，我这里为了展示手动赋值，真是使用直接获取Data长度即可</span><br><span class="line">      platformHeight:0//platform的高度</span><br><span class="line">      showData: [],//被展示的列表Data</span><br><span class="line">      startIndex: 0,//开始截取listData的Index</span><br><span class="line">      showNum: 1,//页面高度可以展示几个列表项</span><br><span class="line">      top: 0,//展示列表盒子绝对定位的top值</span><br><span class="line">      catchFrontNum: 4, //前缓冲区的数量</span><br><span class="line">      catchBackNum: 4,//后缓冲区的数量</span><br><span class="line">      itemHeight: 0,//列表项的高度</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    scrollEvent(e) &#123;</span><br><span class="line">      let scrollTop = e.target.scrollTop//获取滚动的距离</span><br><span class="line">      this.startIndex = Math.ceil(scrollTop / this.itemHeight)//滚动距离除以列表项的高度得到应该展示的列表项Index</span><br><span class="line">      this.startIndex =</span><br><span class="line">        this.startIndex &lt; this.catchFrontNum</span><br><span class="line">          ? 0</span><br><span class="line">          : this.startIndex - this.catchFrontNum//设置前缓冲区</span><br><span class="line">      	//对展示的数组进行截取</span><br><span class="line">        this.showData = this.listData.slice(</span><br><span class="line">        this.startIndex,</span><br><span class="line">        this.startIndex + this.showNum + this.catchBackNum + this.catchFrontNum</span><br><span class="line">      )</span><br><span class="line">      //绝对定位的展示列表项盒子的top值</span><br><span class="line">      this.top = this.startIndex * this.itemHeight</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    const virtualBox = this.$refs.virtualBox // 获取到最外层盒子</span><br><span class="line">    let itemBox = document.getElementsByClassName(&#x27;itemBox&#x27;)[0]</span><br><span class="line">    this.itemHeight = itemBox.offsetHeight//获取列表项</span><br><span class="line">    this.platformHeight = this.count * this.itemHeight</span><br><span class="line">    this.showNum = Math.ceil(virtualBox.clientHeight / this.itemHeight)//外层盒子的可视高度除以列表项高度可以得到展示数量</span><br><span class="line">    this.showData = this.listData.slice(</span><br><span class="line">      this.startIndex,</span><br><span class="line">      this.startIndex + this.showNum + this.catchBackNum+ this.catchFrontNum</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    //做一些假数据用于展示</span><br><span class="line">    let i = 0</span><br><span class="line">    for (i = 0; i &lt; 100; i++) &#123;</span><br><span class="line">      this.listData[i] = &#x27;我是&#x27; + i</span><br><span class="line">    &#125;</span><br><span class="line">    this.showData = this.listData.slice(0, 20)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.trueBox &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0;</span><br><span class="line">&#125;</span><br><span class="line">.itemBox &#123;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color: green;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  padding: 10px;</span><br><span class="line">&#125;</span><br><span class="line">.platform &#123;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">.virtualBox &#123;</span><br><span class="line">  height: 85vh;</span><br><span class="line">  overflow: scroll;</span><br><span class="line">  position: relative;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-进阶段位：不同高度"><a href="#2-进阶段位：不同高度" class="headerlink" title="2.进阶段位：不同高度"></a>2.进阶段位：不同高度</h3><p><img src="/image/tutieshi_640x657_7s.gif" alt="tutieshi_640x594_13s"></p>
<p>与固定高度不同，列表项的高度是不固定的，所以会出现以下这些难点：</p>
<p>①无法通过页面高度除以列表项高度得到应当展示的数量，也就是展示列表的长度</p>
<p>②无法通过滚动了的高度scrollTop除以列表项高度得到此时应该展示的列表项Index</p>
<p>③无法直接通过ListData的长度乘以列表项高度得到platform的高度</p>
<p>对于以上难点我们的解决方案：</p>
<p>①设置一个预告高度，用于计算页面展示的数量，该预估高度建议偏小，避免出现页面展示数量不够的情况</p>
<p>②设置一个position数组，计算并存储每一个列表项的top\bottom\height值，通过比较scrollTop和列表项的position可以得到此时应该展示的列表项Index</p>
<p>③通过position数组获取最后一个列表项的bottom值，即为platform的高度</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;virtualBox&quot; @scroll=&quot;scrollEvent&quot; ref=&quot;virtualBox&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;platform&quot; :style=&quot;&#123; height: platformHeight + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">        &lt;!-- 这是假的容器，作用：撑开盒子和提供滚动效果 --&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;trueBox&quot; :style=&quot;&#123; top: top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">        &lt;div</span><br><span class="line">          v-for=&quot;(item, key) in showData&quot;</span><br><span class="line">          class=&quot;itemBox&quot;</span><br><span class="line">          ref=&quot;items&quot;</span><br><span class="line">          :id=&quot;item.id&quot;</span><br><span class="line">          :key=&quot;item.id&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          看着第&#123;&#123; key &#125;&#125;个 其实第&#123;&#123; item.id &#125;&#125;个</span><br><span class="line">          &#123;&#123; item.value &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;WebFront&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      position: [],</span><br><span class="line">      listData: [],</span><br><span class="line">      platformHeight: 0,</span><br><span class="line">      count: 100,</span><br><span class="line">      scrollTop: 0,</span><br><span class="line">      showData: [],</span><br><span class="line">      startIndex: 0,</span><br><span class="line">      showNum: 0,</span><br><span class="line">      top: 0,</span><br><span class="line">      estimatedItemHeight: 100,//预设高度</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    updateItemsSize() &#123;</span><br><span class="line">        //更新列表项高度</span><br><span class="line">      let nodes = this.$refs.items</span><br><span class="line">      nodes.forEach((node) =&gt; &#123;</span><br><span class="line">        let rect = node.getBoundingClientRect()</span><br><span class="line">        let height = rect.height</span><br><span class="line">        let index = parseInt(node.id)</span><br><span class="line">        let oldHeight = this.position[index].height</span><br><span class="line">        let dValue = oldHeight - height</span><br><span class="line">        if (dValue) &#123;</span><br><span class="line">          this.position[index].bottom = this.position[index].bottom - dValue</span><br><span class="line">          this.position[index].height = height</span><br><span class="line">          for (let k = index + 1; k &lt; this.position.length; k++) &#123;</span><br><span class="line">            this.position[k].top = this.position[k - 1].bottom</span><br><span class="line">            this.position[k].bottom = this.position[k].bottom - dValue</span><br><span class="line">          &#125;</span><br><span class="line">          this.platformHeight = this.position[this.position.length - 1].bottom</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    findStartIndex(scrollTop, list) &#123;</span><br><span class="line">        //根据滚动高度scrollTop找到此时的startIndex</span><br><span class="line">      for (let i = 0, len = list.length; i &lt; len; i++) &#123;</span><br><span class="line">        if (list[i].top &gt; scrollTop) &#123;</span><br><span class="line">          return i - 1</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return list.length - 1</span><br><span class="line">    &#125;,</span><br><span class="line">    scrollEvent(e) &#123;</span><br><span class="line">      this.updateItemsSize()</span><br><span class="line">      this.scrollTop = e.target.scrollTop</span><br><span class="line">      let index = this.findStartIndex(this.scrollTop, this.position)</span><br><span class="line">      this.startIndex =</span><br><span class="line">        index &lt; this.listData.length - 1 - this.showNum</span><br><span class="line">          ? index</span><br><span class="line">          : this.listData.length - 1 - this.showNum</span><br><span class="line">        //至少保留showNum个列表项</span><br><span class="line">      this.showData = this.listData.slice(</span><br><span class="line">        this.startIndex,</span><br><span class="line">        this.startIndex + this.showNum + 2</span><br><span class="line">      )</span><br><span class="line">      this.top = this.position[this.startIndex].top</span><br><span class="line">    &#125;,</span><br><span class="line">    createString(num) &#123;</span><br><span class="line">      let str = &#x27;&#x27;</span><br><span class="line">      for (let i = 0; i &lt; num; i++) &#123;</span><br><span class="line">        str += &#x27;aa&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">      return str</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.position = this.listData.map((item, index) =&gt; (&#123;</span><br><span class="line">      index,</span><br><span class="line">      top: index * this.estimatedItemHeight,</span><br><span class="line">      bottom: (index + 1) * this.estimatedItemHeight,</span><br><span class="line">      height: this.estimatedItemHeight,</span><br><span class="line">    &#125;))</span><br><span class="line">    this.platformHeight = this.position[this.position.length - 1].bottom</span><br><span class="line">    this.showNum = Math.ceil(</span><br><span class="line">      this.$refs.virtualBox.clientHeight / this.estimatedItemHeight</span><br><span class="line">    )</span><br><span class="line">    this.showData = this.listData.slice(</span><br><span class="line">      this.startIndex,</span><br><span class="line">      this.startIndex + this.showNum + 2</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    let i = 0</span><br><span class="line">    for (i = 0; i &lt; 100; i++) &#123;</span><br><span class="line">      this.listData[i] = &#123;&#125;</span><br><span class="line">      this.listData[i].value = this.createString(</span><br><span class="line">        Math.floor(Math.random() * 100)</span><br><span class="line">      )</span><br><span class="line">      this.listData[i].id = i</span><br><span class="line">    &#125;</span><br><span class="line">    this.showData = this.listData.slice(0, 20)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.trueBox &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0;</span><br><span class="line">&#125;</span><br><span class="line">.itemBox &#123;</span><br><span class="line">  background-color: green;</span><br><span class="line">  display: block;</span><br><span class="line">  line-height: 100%;</span><br><span class="line">  word-break: break-all;</span><br><span class="line">  width: 100px;</span><br><span class="line">  padding: 10px;</span><br><span class="line">  border: 2px purple solid;</span><br><span class="line">&#125;</span><br><span class="line">.platform &#123;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">.virtualBox &#123;</span><br><span class="line">  height: 85vh;</span><br><span class="line">  overflow: scroll;</span><br><span class="line">  position: relative;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-高阶段位：变化高度"><a href="#3-高阶段位：变化高度" class="headerlink" title="3.高阶段位：变化高度"></a>3.高阶段位：变化高度</h3><p>这种情况可能出现在比如列表项因为太长而设置了展开/收缩按钮，此时列表项的高度是动态发生变化的，这种情况和上一种情况差不多，区别只在于这种情况只需要在点击按钮的时候将position更新即可~所以在这里不做代码演示啦</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>了解了原理要写出来还是不难的~但我个人感觉有的时候前端的进阶难就难在止步于此，现在的浏览器性能好，可能写N个DOM都不会卡顿，很难会有觉悟自己去写一个虚拟列表来试试看性能是不是更好。希望自己永不止步，永远进步</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/02/valueOf&toString/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/02/valueOf&toString/" class="post-title-link" itemprop="url">在你不知道的地方JS偷偷调用了valueOf和toString！</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-03-02 20:34:43 / Modified: 21:08:25" itemprop="dateCreated datePublished" datetime="2024-03-02T20:34:43+08:00">2024-03-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>JavaScript中valueOf、toString的隐式调用</p>
<p>在你不知道的地方JS偷偷调用了valueOf和toString！</p>
<h3 id="一、问题引入"><a href="#一、问题引入" class="headerlink" title="一、问题引入"></a>一、问题引入</h3><p>你知道执行以下三种情况，控制台会打印什么吗？</p>
<h4 id="（1）情况一：方法的返回值为1"><a href="#（1）情况一：方法的返回值为1" class="headerlink" title="（1）情况一：方法的返回值为1"></a>（1）情况一：方法的返回值为1</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;函数内打印&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"><span class="built_in">console</span>.log(fn)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + arr)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + fn)</span><br></pre></td></tr></table></figure>

<h4 id="（2）情况二：方法无返回值"><a href="#（2）情况二：方法无返回值" class="headerlink" title="（2）情况二：方法无返回值"></a>（2）情况二：方法无返回值</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用toString方法&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用valueOf方法&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用toString方法&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用valueOf方法&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;函数内打印&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"><span class="built_in">console</span>.log(fn)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + arr)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + fn)</span><br></pre></td></tr></table></figure>

<h4 id="（3）情况三：方法返回值为一个匿名函数"><a href="#（3）情况三：方法返回值为一个匿名函数" class="headerlink" title="（3）情况三：方法返回值为一个匿名函数"></a>（3）情况三：方法返回值为一个匿名函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;函数内打印&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br><span class="line"><span class="built_in">console</span>.log(fn)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + arr)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;console.log-----&#x27;</span> + fn)</span><br></pre></td></tr></table></figure>

<p>控制台输出如下，你答对了吗？</p>
<h4 id="控制台输出结果："><a href="#控制台输出结果：" class="headerlink" title="控制台输出结果："></a>控制台输出结果：</h4><p><img src="/image/image-20220809115757055.png" alt="image-20220809115757055.png"></p>
<p><img src="/image/image-20220809115923874.png" alt="image-20220809115923874"></p>
<p><img src="/image/image-20220809115959212.png" alt="image-20220809115757055.png"></p>
<p>全对的大佬可以出门左转了，出现错误的同学请继续往下看~</p>
<h3 id="二、具体情况分析"><a href="#二、具体情况分析" class="headerlink" title="二、具体情况分析"></a>二、具体情况分析</h3><p>针对直接使用cosole.log打印单独的对象，打印语句一在三种情况下都发挥正常。但是往下看，打印语句二<code>console.log(fn)</code></p>
<p><img src="/image/image-20220809121806237.png" alt="image-20220809121806237"></p>
<p><img src="/image/image-20220809121817987.png" alt="image-20220809121817987"></p>
<p><img src="/image/image-20220809121828969.png" alt="image-20220809121828969"></p>
<ul>
<li>  方法返回值为1：打印函数体，自动调用toString()</li>
<li>  方法无返回值(undefined)：打印函数体，自动调用toString()</li>
<li>  方法返回匿名函数：打印函数体，自动调用toString()之后调用valueOf()</li>
</ul>
<p>从上面的结果中我们猜测，当打印的内容为函数时，会在内部隐式调用toString()，如果toString()返回基本数据类型，则数据转换到此为止。如果返回对象数据类型，则在toString()之后还会调用valueOf()。</p>
<p>打印语句3和4：</p>
<p><img src="/image/image-20220809121901299.png" alt="image-20220809121901299"><img src="/image/image-20220809121914502.png" alt="image-20220809121914502"><img src="/image/image-20220809121925724.png" alt="image-20220809121925724"></p>
<ul>
<li>  方法返回值为1：自动调用valueOf()，打印valueOf()返回值</li>
<li>  方法无返回值(undefined)：自动调用valueOf()，打印valueOf()返回值</li>
<li>  方法返回匿名函数：自动调用valueOf()之后调用toString()，报错</li>
</ul>
<p>有报错最好~从报的错误开始入手</p>
<p>TypeError: Cannot convert object to primitive value</p>
<p>翻译：不能将对象转换为原始值<br>查阅资料发现引用类型向原始类型转换遵循ToPrimitive规则</p>
<h4 id="⭐️ToPrimitive规则"><a href="#⭐️ToPrimitive规则" class="headerlink" title="⭐️ToPrimitive规则"></a>⭐️ToPrimitive规则</h4><p>是引用类型向原始类型转变的规则，它遵循先valueOf后toString的模式期望得到一个原始类型。如果还是没法得到一个原始类型，就会抛出 TypeError。</p>
<h3 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h3><h4 id="1-明确转换类型："><a href="#1-明确转换类型：" class="headerlink" title="1.明确转换类型："></a>1.明确转换类型：</h4><p>如alert，console.log明确引用类型是要转换为字符串类型，那么采用的策略是先toString后valueOf。</p>
<h4 id="2-不明确转换类型："><a href="#2-不明确转换类型：" class="headerlink" title="2.不明确转换类型："></a>2.不明确转换类型：</h4><p>如隐式类型转换，那么采用ToPrimitive规则，遵循先valueOf后toString的模式期望得到一个原始类型。</p>
<h4 id="MDN中valueOf-方法的返回值："><a href="#MDN中valueOf-方法的返回值：" class="headerlink" title="MDN中valueOf()方法的返回值："></a>MDN中valueOf()方法的返回值：</h4><p><img src="/image/image-20220809110411560.png" alt="image-20220809110411560"></p>
<h4 id="toString方法返回值"><a href="#toString方法返回值" class="headerlink" title="toString方法返回值"></a>toString方法返回值</h4><p><img src="/image/20190719180630686.png" alt="20190719180630686"></p>
<h4 id="3-返回值："><a href="#3-返回值：" class="headerlink" title="3.返回值："></a>3.返回值：</h4><p>在复写这两个函数时，函数返回值起着关键作用，可以决定调用几个方法和最后函数的返回值。好好利用这一特点与隐式自动调用的模式，助力成为装逼达人！</p>
<h4 id="4-注意点："><a href="#4-注意点：" class="headerlink" title="4.注意点："></a>4.注意点：</h4><p>alert会将两个方法最后得到的原始类型值进行返回</p>
<p><img src="/image/image-20220809113133100.png" alt="image-20220809113133100"><br>但是console.log不会，还是返回函数体。</p>
<p>其他引用类型类似，可以自己动手试试。</p>
<h3 id="四、问题"><a href="#四、问题" class="headerlink" title="四、问题"></a>四、问题</h3><p>对于console.log这个操作不太理解，使用alert阻塞。可以看到先提示调用方法，但是确认完alert弹窗之后，居然console.log打印语句出现在了上面。实在是不理解，希望有懂的大佬不吝赐教。</p>
<p><img src="/image/image-20220809153623938.png" alt="image-20220809153623938"> <img src="C:\Users\吴佳愉\AppData\Roaming\Typora\typora-user-images\image-20220809153646505.png" alt="image-20220809153646505"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用toString方法&#x27;</span>)</span><br><span class="line">  alert(<span class="string">&#x27;array-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;array-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  alert(<span class="string">&#x27;array-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用toString方法&#x27;</span>)</span><br><span class="line">  alert(<span class="string">&#x27;function-----调用toString方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;function-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  alert(<span class="string">&#x27;function-----调用valueOf方法&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;函数内打印&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="built_in">console</span>.log(fn);</span><br></pre></td></tr></table></figure>

<h3 id="五、踩坑心得"><a href="#五、踩坑心得" class="headerlink" title="五、踩坑心得"></a>五、踩坑心得</h3><p>事情是这样的，学习的时候看到一篇文章，对照着文章中的进行实践操作却得不到一样的结果，于是顺藤摸瓜摸出了这么多瓜。。。从柯里化到隐式调用到隐式类型转换。</p>
<p><img src="/image/image-20220809094045150.png" alt="image-20220809094045150"></p>
<h3 id="六、参考："><a href="#六、参考：" class="headerlink" title="六、参考："></a>六、参考：</h3><ul>
<li>  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/aNd1coder/archive/2013/03/09/2951959.html">https://www.cnblogs.com/aNd1coder/archive/2013/03/09/2951959.html</a></li>
<li>  <a target="_blank" rel="noopener" href="https://www.jb51.net/article/32327.htm">https://www.jb51.net/article/32327.htm</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/11/nodejs-nvm%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/12/11/nodejs-nvm%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">nodejs nvm安装</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-11 15:47:20" itemprop="dateCreated datePublished" datetime="2023-12-11T15:47:20+08:00">2023-12-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-02 21:08:34" itemprop="dateModified" datetime="2024-03-02T21:08:34+08:00">2024-03-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>记录一下今天安装nvm过程遇到的一些问题~</p>
<p>nvm是一个node的版本管理工具，很适合我这种需要很多node版本的人</p>
<p>我的安装步骤：</p>
<ol>
<li>卸载原有的nodejs，我这一步卸得太干净了。。。把之前下的包都删掉了，悲伤悲伤（；´д｀）ゞ  其实可以不用卸载原有的nodejs的，nvm可以将现有的nodejs添加到管理中的</li>
<li><a target="_blank" rel="noopener" href="https://github.com/coreybutler/nvm-windows/releases">nvm下载地址</a></li>
<li>安装完成后使用<code>nvm -v</code>检查一下nvm是否安装成功</li>
<li>安装成功后就可以使用以下命令使用啦：<ul>
<li>nvm on:开启nvm的nodejs版本管理</li>
<li>nvm intall <version>:安装指定版本</li>
<li>nvm use <version>:使用指定版本</li>
<li>nvm list [available]:显示已安装的列表。可选参数available，显示可安装的所有版本。list可简化为ls。</li>
<li>nvm uninstall <version>:卸载指定版本</li>
<li>nvm off:关闭nvm的nodejs版本管理</li>
</ul>
</li>
</ol>
<p>遇到的问题一：无法创建文件夹</p>
<p><img src="/image/image-20231211155947870.png" alt="image-20231211155947870"></p>
<p>解决办法：使用管理员身份打开cmd即可，给程序创建文件夹的权限</p>
<p>遇到的问题二：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\asus\Desktop\visual_sense_3d&gt;npm i cnpm -g</span><br><span class="line">npm ERR! code ETIMEDOUT</span><br><span class="line">npm ERR! errno ETIMEDOUT</span><br><span class="line">npm ERR! network request to https://registry.npmjs.org/graceful-readlink failed, reason: connect ETIMEDOUT 104.16.25.35:443</span><br><span class="line">npm ERR! network This is a problem related to network connectivity.</span><br><span class="line">npm ERR! network In most cases you are behind a proxy or have bad network settings.</span><br><span class="line">npm ERR! network</span><br><span class="line">npm ERR! network If you are behind a proxy, please make sure that the</span><br><span class="line">npm ERR! network &#x27;proxy&#x27; config is set properly.  See: &#x27;npm help config&#x27;</span><br><span class="line"> </span><br><span class="line">npm ERR! A complete log of this run can be found in:</span><br><span class="line">npm ERR!     C:\Users\Deshun\AppData\Roaming\npm-cache\_logs\2023-12-01T03_09_36_539Z-debug.log</span><br></pre></td></tr></table></figure>

<p>解决方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.查看npm镜像设置</span><br><span class="line">npm config get registry</span><br><span class="line">2.将npm设置为淘宝镜像</span><br><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line">3.再次查看npm镜像设置</span><br><span class="line">npm config get registry</span><br></pre></td></tr></table></figure>

<p>应该是由于我前面安装nvm的时候在setting.txt文件中已经修改了node的镜像为taobao，所以在这个地方也要对应修改</p>
<p>安装完毕，美美用起nvm，真的很方便，随意丝滑切换node版本(￣︶￣*))</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/11/22/chrome-devtools/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/11/22/chrome-devtools/" class="post-title-link" itemprop="url">chrome-devtools > Application</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-11-22 12:45:18 / Modified: 15:26:17" itemprop="dateCreated datePublished" datetime="2023-11-22T12:45:18+08:00">2023-11-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Application-gt-Manifest"><a href="#Application-gt-Manifest" class="headerlink" title="Application &gt; Manifest"></a>Application &gt; Manifest</h3><p><img src="https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/t2qbshH5F1g24IcsNbZz.png?auto=format" alt="清单窗格。"></p>
<p>:sunflower:作用：</p>
<p>当你希望用户能够将该引用程序添加到Mac OS上的“应用程序”文件夹、Windows上的“开始”菜单以及Android和IOS上的主屏幕时，需要一个Web应用程序清单。设置应用程序清单后，可以打开devtools中的Manifest中检验配置是否正确。</p>
<p>:sunflower:编写Web应用程序清单：</p>
<p>清单文件可采用任何名称，但通常命名为 <code>manifest.json</code>，并从根目录（网站的顶级目录）提供。该规范建议该扩展项应为 <code>.webmanifest</code>，但浏览器也支持 <code>.json</code> 扩展项。</p>
<p>创建清单后，将 <code>&lt;link&gt;</code> 标记添加到渐进式 Web 应用的所有页面。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;manifest&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/manifest.json&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>具体的Manifest编写规则和配置项如下：<a target="_blank" rel="noopener" href="https://web.dev/articles/add-manifest?hl=zh-cn">https://web.dev/articles/add-manifest?hl=zh-cn</a></p>
<h3 id="Application-gt-Service-Worker"><a href="#Application-gt-Service-Worker" class="headerlink" title="Application &gt; Service Worker"></a>Application &gt; Service Worker</h3><p><img src="https://wd.imgix.net/image/NJdAV9UgKuN8AhoaPBquL7giZQo1/TATykdak02rXVcKINPJ5.png?auto=format" alt="Service Worker 窗格。"></p>
<p>在该位置我们对Service Worker进行检查和调试</p>
<p>:sunflower:Service Worker ：</p>
<p>本质上充当位于 Web 应用程序、浏览器和网络（如果可用）之间的代理服务器。除其他外，它们的目的是创建有效的离线体验、拦截网络请求并根据网络是否可用采取适当的操作，以及更新服务器上的资产。它们还允许访问推送通知和后台同步 API。</p>
<p>:sunflower:特性：</p>
<ol>
<li>没有DOM访问权限</li>
<li>无法动态导入JS模块，如果在Service Worker全局范围内调用<code>import().</code>则会抛出异常，但允许使用<code>import</code>语句进行静态导入</li>
<li>Service Worker被设计为完全异步，在与主JavaScript不同的线程上运行，因此它是非阻塞的，所以同步XHR和Web Storage等API无法在Service Worker内部进行使用</li>
<li>仅允许通过HTTPS运行</li>
</ol>
<p>具体编写Service Worker参考如下：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API</a></p>
<h3 id="Application-gt-LocalStorage"><a href="#Application-gt-LocalStorage" class="headerlink" title="Application &gt; LocalStorage"></a>Application &gt; LocalStorage</h3><p>localStorage 用于长久保存整个网站的数据，保存的数据没有过期时间，直到手动去删除。</p>
<p><strong>:hatched_chick:localStorage 的优势</strong></p>
<ul>
<li> 1、localStorage 拓展了 cookie 的 4K 限制。</li>
<li> 2、localStorage 会可以将第一次请求的数据直接存储到本地，这个相当于一个 5M 大小的针对于前端页面的数据库，相比于 cookie 可以节约带宽，但是这个却是只有在高版本的浏览器中才支持的。</li>
</ul>
<p><strong>:hatched_chick:localStorage 的局限</strong></p>
<ul>
<li> 1、浏览器的大小不统一，并且在 IE8 以上的 IE 版本才支持 localStorage 这个属性。</li>
<li> 2、目前所有的浏览器中都会把localStorage的值类型限定为string类型，这个在对我们日常比较常见的JSON对象类型需要一些转换。</li>
<li> 3、localStorage在浏览器的隐私模式下面是不可读取的。</li>
<li> 4、localStorage本质上是对字符串的读取，如果存储内容多的话会消耗内存空间，会导致页面变卡。</li>
<li> 5、localStorage不能被爬虫抓取到。</li>
</ul>
<p>localStorage 与 sessionStorage 的唯一一点区别就是 localStorage 属于永久性存储，而 sessionStorage 属于当会话结束的时候，sessionStorage 中的键值对会被清空。</p>
<p><strong>:japanese_ogre:不可以设置过期时间不可以设置过期时间，但是开发者可以自己判断时间然后把它移除，但是它本身是没有设置过期时间的这个操作的</strong></p>
<h6 id="hatched-chick-人工设置过期时间"><a href="#hatched-chick-人工设置过期时间" class="headerlink" title=":hatched_chick:人工设置过期时间"></a><strong>:hatched_chick:人工设置过期时间</strong></h6><p>其实都是set方法多传个过期时间啦</p>
<ol>
<li><p>ES5扩展Storage</p>
<p>思路很简单，存储的值加一个时间戳，下次取值时验证时间戳。<br><strong>注意：</strong> <code>localStorage</code>只能存储字符，存入时将对象转为<code>json</code>字符串,读取时也要解析</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Storage.prototype.setExpire = <span class="function">(<span class="params">key, value, expire</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">let</span> obj = &#123;</span><br><span class="line">	<span class="attr">data</span>: value,</span><br><span class="line">	<span class="attr">time</span>: <span class="built_in">Date</span>.now(),</span><br><span class="line">	<span class="attr">expire</span>: expire</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">//localStorage 设置的值不能为对象,转为json字符串</span></span><br><span class="line">	<span class="built_in">localStorage</span>.setItem(key, <span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Storage.prototype.getExpire = <span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> val = <span class="built_in">localStorage</span>.getItem(key);</span><br><span class="line">    <span class="keyword">if</span> (!val) &#123;</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line">    val = <span class="built_in">JSON</span>.parse(val);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Date</span>.now() - val.time &gt; val.expire) &#123;</span><br><span class="line">        <span class="built_in">localStorage</span>.removeItem(key);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val.data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>ES6拓展Storage</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Storage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.props = props || &#123;&#125;</span><br><span class="line">        <span class="built_in">this</span>.source = <span class="built_in">this</span>.props.source || <span class="built_in">window</span>.localStorage</span><br><span class="line">        <span class="built_in">this</span>.initRun();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">initRun</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * set 存储方法</span></span><br><span class="line"><span class="comment">        * @ param &#123;String&#125;     key 键</span></span><br><span class="line"><span class="comment">        * @ param &#123;String&#125;     value 值，存储的值可能是数组/对象，不能直接存储，需要转换 JSON.stringify</span></span><br><span class="line"><span class="comment">        * @ param &#123;String&#125;     expired 过期时间，以分钟为单位</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">const</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;__expires__&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> data = <span class="built_in">this</span>.source;</span><br><span class="line">        <span class="keyword">let</span> list = <span class="built_in">Object</span>.keys(data);</span><br><span class="line">        <span class="keyword">if</span>(list.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            list.map(<span class="function">(<span class="params">key,v</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>( !reg.test(key ))&#123;</span><br><span class="line">                    <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">                    <span class="keyword">let</span> expires = data[<span class="string">`<span class="subst">$&#123;key&#125;</span>__expires__`</span>]||<span class="built_in">Date</span>.now+<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (now &gt;= expires ) &#123;</span><br><span class="line">                        <span class="built_in">this</span>.remove(key);</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="keyword">return</span> key;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="title">set</span>(<span class="params">key, value, expired</span>)</span> &#123;</span><br><span class="line">	    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	    * set 存储方法</span></span><br><span class="line"><span class="comment">	    * @ param &#123;String&#125;     key 键</span></span><br><span class="line"><span class="comment">	    * @ param &#123;String&#125;     value 值，</span></span><br><span class="line"><span class="comment">	    * @ param &#123;String&#125;     expired 过期时间，以毫秒为单位，非必须</span></span><br><span class="line"><span class="comment">	    */</span></span><br><span class="line">	    <span class="keyword">let</span> source = <span class="built_in">this</span>.source;</span><br><span class="line">	    source[key] = <span class="built_in">JSON</span>.stringify(value);</span><br><span class="line">	    <span class="keyword">if</span> (expired)&#123;</span><br><span class="line">	        source[<span class="string">`<span class="subst">$&#123;key&#125;</span>__expires__`</span>] = <span class="built_in">Date</span>.now() + expired</span><br><span class="line">	    &#125;;</span><br><span class="line">	    <span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params">key</span>)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * get 获取方法</span></span><br><span class="line"><span class="comment">        * @ param &#123;String&#125;     key 键</span></span><br><span class="line"><span class="comment">        * @ param &#123;String&#125;     expired 存储时为非必须字段，所以有可能取不到，默认为 Date.now+1</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">const</span> source = <span class="built_in">this</span>.source,</span><br><span class="line">        expired = source[<span class="string">`<span class="subst">$&#123;key&#125;</span>__expires__`</span>]||<span class="built_in">Date</span>.now+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">const</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> ( now &gt;= expired ) &#123;</span><br><span class="line">            <span class="built_in">this</span>.remove(key);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> value = source[key] ? <span class="built_in">JSON</span>.parse(source[key]) : source[key];</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="title">remove</span>(<span class="params">key</span>)</span> &#123;</span><br><span class="line">	    <span class="keyword">const</span> data = <span class="built_in">this</span>.source,</span><br><span class="line">	        value = data[key];</span><br><span class="line">	    <span class="keyword">delete</span> data[key];</span><br><span class="line">	    <span class="keyword">delete</span> data[<span class="string">`<span class="subst">$&#123;key&#125;</span>__expires__`</span>];</span><br><span class="line">	    <span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h6 id="hatched-chick-存取格式"><a href="#hatched-chick-存取格式" class="headerlink" title=":hatched_chick:存取格式"></a><strong>:hatched_chick:存取格式</strong></h6><p>localStorage 只支持 string 类型的存储，存入数字取出来的类型也是字符串</p>
<p>需要存入对象时先使用Json.stringify转换为json字符串，取出之后再转换为对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> storage=<span class="built_in">window</span>.localStorage;</span><br><span class="line"><span class="keyword">var</span> data=&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;xiecanyong&#x27;</span>,</span><br><span class="line">    <span class="attr">sex</span>:<span class="string">&#x27;man&#x27;</span>,</span><br><span class="line">    <span class="attr">hobby</span>:<span class="string">&#x27;program&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> d=<span class="built_in">JSON</span>.stringify(data);</span><br><span class="line">storage.setItem(<span class="string">&quot;data&quot;</span>,d);</span><br><span class="line"><span class="comment">//将JSON字符串转换成为JSON对象输出</span></span><br><span class="line"><span class="keyword">var</span> json=storage.getItem(<span class="string">&quot;data&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> jsonObj=<span class="built_in">JSON</span>.parse(json);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> jsonObj);</span><br></pre></td></tr></table></figure>

<h6 id="hatched-chick-增删改查"><a href="#hatched-chick-增删改查" class="headerlink" title=":hatched_chick:增删改查"></a><strong>:hatched_chick:增删改查</strong></h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.setItem(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> lastname = <span class="built_in">localStorage</span>.getItem(<span class="string">&quot;key&quot;</span>);</span><br><span class="line"><span class="built_in">localStorage</span>.removeItem(<span class="string">&quot;key&quot;</span>);<span class="comment">//删除某个键值对</span></span><br><span class="line"><span class="built_in">localStorage</span>.clear()<span class="comment">//删除所有localStorage</span></span><br></pre></td></tr></table></figure>



<h3 id="Application-gt-SessionStorage"><a href="#Application-gt-SessionStorage" class="headerlink" title="Application &gt; SessionStorage"></a>Application &gt; SessionStorage</h3><p>sessionStorage 用于临时保存同一窗口(或标签页)的数据，在关闭窗口或标签页之后将会删除这些数据。</p>
<h6 id="ant-存取格式"><a href="#ant-存取格式" class="headerlink" title=":ant:存取格式"></a><strong>:ant:存取格式</strong></h6><p>和localStorage相同</p>
<h6 id="ant-增删改查"><a href="#ant-增删改查" class="headerlink" title=":ant:增删改查"></a><strong>:ant:增删改查</strong></h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.setItem(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> lastname = sessionStorage.getItem(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">sessionStorage.removeItem(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">sessionStorage.clear();</span><br></pre></td></tr></table></figure>



<h3 id="Application-gt-IndexDB-amp-WebSql"><a href="#Application-gt-IndexDB-amp-WebSql" class="headerlink" title="Application &gt; IndexDB&amp;WebSql"></a>Application &gt; IndexDB&amp;WebSql</h3><p>这两者主要用在前端有大容量存储的页面上，例如，在线编辑浏览器或者网页邮箱</p>
<table>
<thead>
<tr>
<th></th>
<th>介绍</th>
<th>容量</th>
<th>状态</th>
</tr>
</thead>
<tbody><tr>
<td>WebSql</td>
<td>关系型数据库</td>
<td>大小限制因浏览器而异，但<strong>一般为5MB-50MB的范围</strong></td>
<td>被W3C标准废弃</td>
</tr>
<tr>
<td>IndexDB</td>
<td>非关系型数据库</td>
<td><strong>存储大小是250m以上</strong>（受计算机硬件和浏览器厂商的限制）</td>
<td>正常使用</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/11/BScroll/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/11/BScroll/" class="post-title-link" itemprop="url">BScroll</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-09-11 12:45:18" itemprop="dateCreated datePublished" datetime="2020-09-11T12:45:18+08:00">2020-09-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2020-09-17 16:00:17" itemprop="dateModified" datetime="2020-09-17T16:00:17+08:00">2020-09-17</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<ul>
<li>原生的js滚动在移动端上会发生卡顿，没有惯性和首尾弹簧功能，于是选择Better Scroll这个框架来适配移动端的滚动</li>
<li>优点：使用原生JS，不依赖任何框架，体积小</li>
</ul>
<blockquote>
<p>BScroll的安装</p>
</blockquote>
<p>安装：<code>npm install better-scroll --save</code></p>
<p>引用：</p>
<ol>
<li>vue项目：<code>import BScroll from &#39;better-scroll&#39;</code></li>
<li>js项目：直接下载bscroll.js文件然后引入就可以</li>
</ol>
<blockquote>
<p>使用</p>
</blockquote>
<p>HTML部分：</p>
<ul>
<li>在最外面需要包一层</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JS部分：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现滚动功能</span></span><br><span class="line"><span class="keyword">const</span> bscroll = <span class="keyword">new</span> BScroll(<span class="built_in">document</span>.querySelector(<span class="string">&#x27;.content&#x27;</span>),&#123;&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//监听实时滚动位置</span></span><br><span class="line"><span class="keyword">const</span> bscroll = <span class="keyword">new</span> BScroll(<span class="built_in">document</span>.querySelector(<span class="string">&#x27;.content&#x27;</span>),&#123;</span><br><span class="line">    <span class="attr">probeType</span>:<span class="number">2</span></span><br><span class="line">    <span class="comment">//0或者1都是不检测实时位置</span></span><br><span class="line">    <span class="comment">//2:在手指滚动的过程中侦测，手指离开后的惯性滚动过程不侦测</span></span><br><span class="line">    <span class="comment">//3:在手指滚动和惯性滚动过程都进行侦测</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//上拉加载更多</span></span><br><span class="line"><span class="keyword">const</span> bscroll = <span class="keyword">new</span> BScroll(<span class="built_in">document</span>.querySelector(<span class="string">&#x27;.content&#x27;</span>),&#123;</span><br><span class="line">    <span class="attr">pullUpLoad</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line">bscroll.on(<span class="string">&#x27;pullingUp&#x27;</span>,<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;发生上拉加载动作，发送网络请求的代码可以写在这里&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//等数据请求完成，并且将新的数据展示出来之后</span></span><br><span class="line">    <span class="comment">//调用这个函数之后才能进行下一次的下拉加载更多</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        bscroll.finishPullUp()</span><br><span class="line">    &#125;,<span class="number">2000</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<blockquote>
<p>点击回到顶部</p>
</blockquote>
<p>对new出来的BScroll对象使用scrollTo方法</p>
<p><code>bscroll.scrollTo(0,0，500)</code>500毫秒回到顶部</p>
<blockquote>
<p>缺点</p>
</blockquote>
<p>当滚动内容里面有图片时会偶尔出现bug，可能在 BS计算滚动内容的高度的时候图片还没加载过来，这时会导致记得算出来的高度比实际的高度低出现滚动问题</p>
<p>解决办法：图片的<code>@load</code>监听图片加载完成再对BS进行refresh</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/08/CSS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/08/CSS/" class="post-title-link" itemprop="url">CSS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-09-08 12:45:18" itemprop="dateCreated datePublished" datetime="2020-09-08T12:45:18+08:00">2020-09-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2020-09-09 21:48:51" itemprop="dateModified" datetime="2020-09-09T21:48:51+08:00">2020-09-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>vue中css文件引入</p>
</blockquote>
<p><code>import &quot;./normalize.css&quot;</code></p>
<blockquote>
<p>CSS中的变量</p>
</blockquote>
<ol>
<li><p><code>:root</code>获取根元素html</p>
</li>
<li><p>定义变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:root&#123;</span><br><span class="line">    --color-text: #<span class="number">666</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>使用变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">div&#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="keyword">var</span>(--color-text)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>用在设置多个相同颜色的时候很方便:D</p>
<blockquote>
<p>position: sticky</p>
</blockquote>
<p>使用该属性的时候要设置top属性</p>
<p>当该元素小于这个高度时正常滚动，当该元素大于这个高度时会被固定在这个高度</p>
<p>好用的属性一般不兼容 :(</p>
<blockquote>
<p>神奇属性在哪里</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap; <span class="comment">/*去掉会让所有的子元素排列在一排不会换行噢*/</span></span><br><span class="line">    <span class="attribute">justify-content</span>: space-evenly;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span>&gt;<span class="selector-tag">div</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">47%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以做到div里面的div元素flex布局，而且一行刚好两个（通过调整子元素的宽度可以决定一行里面有多少个子元素），再通过<code>justify-content</code>属性可以让它们之间的间隙各种等分！间隙等分，子元素等分都有，建议实践出真知，真的超级神奇</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/06/websocket/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/06/websocket/" class="post-title-link" itemprop="url">WebSocket与长轮询</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-09-06 12:45:18 / Modified: 15:31:38" itemprop="dateCreated datePublished" datetime="2020-09-06T12:45:18+08:00">2020-09-06</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>为了实现实时更新或类似于聊天室的应用</p>
<ol>
<li><p>一开始想到的肯定是配合setTimeout每隔一小段时间就给服务器发送请求，但是这样给服务器的压力很大，不够随机应变太耗费资源</p>
</li>
<li><p>第二个尝试地是长轮询，顾名思义，是服务器发出一个时间比较长的请求。比如时间设定为30秒，在30秒之内，如果收到服务器更新的数据，则进行对应的操作之后再发出请求，如果在30秒之内没有收到返回数据则执行error回调函数继续发出请求。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ask</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;http://47.92.139.26:8080/spring-boot-panda-0.0.1-SNAPSHOT/question/getNew/&quot;</span> + lastId + <span class="string">&quot;/&quot;</span> + questionId</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">        <span class="attr">async</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">        <span class="attr">timeout</span>: <span class="string">&quot;30000&quot;</span>,</span><br><span class="line">        <span class="comment">//服务器发出一个30秒的请求</span></span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">            done</span><br><span class="line">            Ask();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            done</span><br><span class="line">            Ask();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种操作比起第一种肯定会比较节约资源，但是本质还是没有改变，还是客户端和服务器之间的单向对话，不够随机应变:D</p>
</li>
<li><p>最后使用了WebSocket，操作简单体验感很好:accept:</p>
<p>（记得引入对应的WebSocket包</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打开双通道</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> socket = <span class="keyword">new</span> SockJS(<span class="string">&#x27;http://47.92.139.26:8080/spring-boot-panda-0.0.1-SNAPSHOT/endpointAnswer&#x27;</span>); </span><br><span class="line">    <span class="comment">//新建一个WebSocket对象</span></span><br><span class="line">    </span><br><span class="line">    stompClient = Stomp.over(socket);</span><br><span class="line">    <span class="comment">//使用STMOP子协议的WebSocket客户端</span></span><br><span class="line">    </span><br><span class="line">    stompClient.connect(&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">frame</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//连接WebSocket服务端</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//广播接收信息</span></span><br><span class="line">        stompTopic();</span><br><span class="line">         QuesTest = <span class="number">1</span>; </span><br><span class="line">        <span class="built_in">localStorage</span>.setItem(<span class="string">&#x27;QuesTest&#x27;</span>, QuesTest);</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭双通道</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">disconnect</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(stompClient != <span class="literal">null</span>) &#123;</span><br><span class="line">        stompClient.disconnect();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Disconnected&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//广播（一对多） = 接收服务器传过来的消息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stompTopic</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//通过stompClient.subscribe订阅目标(destination)发送的消息（广播接收信息）</span></span><br><span class="line">    stompClient.subscribe(<span class="string">&#x27;/answerMass/getNew&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;       </span><br><span class="line">        done</span><br><span class="line">    &#125;);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//群发 = 发送消息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendMassMessage</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>WebSocket和之前两种方式的原理都不一样，WebSocket可以打开双通道，做到请求不止可以有客户端发起也可以有服务器发出来，实现了双向对话，节约资源。一般有四个函数：打开双通道，接收服务器发送的消息，给服务器发消息，关闭双通道。</p>
<p><strong>总结： WebSocket真香！</strong></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/01/Ajax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/01/Ajax/" class="post-title-link" itemprop="url">Ajax</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-08-01 12:45:18" itemprop="dateCreated datePublished" datetime="2020-08-01T12:45:18+08:00">2020-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2020-08-15 21:49:58" itemprop="dateModified" datetime="2020-08-15T21:49:58+08:00">2020-08-15</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>[TOC]</p>
<h3 id="PHP基础语法"><a href="#PHP基础语法" class="headerlink" title="PHP基础语法"></a>PHP基础语法</h3><ul>
<li><p>定义变量：<code>$num = 10;</code></p>
</li>
<li><p>定义数组：<code>$arr = array(1,3,5);</code></p>
</li>
<li><p>打印内容：<code>echo $num;</code></p>
<p>echo不能输出集合，比如打印数组什么的</p>
</li>
<li><p><code>print_r($arr); // Array([0] =&gt; 1 [1] =&gt; 3 [2] =&gt; 5)</code></p>
<p><code>echo arr[0]; // 1</code></p>
</li>
<li><p>定义字典（对象）：<code>$dict = array(&quot;name&quot;=&gt;&quot;lnj&quot;, &quot;age&quot;=&gt;&quot;33&quot;)</code></p>
<p><code>echo $dict[&quot;name&quot;];</code></p>
</li>
<li><p>分支循环：if/switch/三目/for/while   和JS的一样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$arr = array(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>;$i &lt; count($arr),$i++)&#123;	<span class="comment">//count($arr)获取数组长度</span></span><br><span class="line">    echo $arr[$i];</span><br><span class="line">    echo <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>后端编写的代码不能直接运行，只能放到服务器对应的文件夹下，通过服务器运行</p>
</li>
</ul>
<h3 id="get请求"><a href="#get请求" class="headerlink" title="get请求"></a>get请求</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://www.baidu.com&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;userPwd&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    print_r(<span class="variable">$_GET</span>); <span class="comment">// Array([userName] =&gt; xx [userPwd] =&gt; 123456)</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&quot;userName&quot;</span>];</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&quot;userPwd&quot;</span>];</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Post请求"><a href="#Post请求" class="headerlink" title="Post请求"></a>Post请求</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;http://www.baidu.com&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;userName&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;password&quot; name=&quot;userPwd&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    print_r($_POST); </span><br><span class="line">	echo $_POST[&quot;userName&quot;];</span><br><span class="line">	echo $_POST[&quot;userPwd&quot;];</span><br><span class="line">    ?&gt;</span><br></pre></td></tr></table></figure>



<p>GET请求和POST请求的异同：</p>
<ul>
<li><p>相同点：</p>
<p>​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            都是将数据提交到远程服务器</p>
</li>
<li><p>不同点：</p>
</li>
</ul>
<ol>
<li><p>GET请求会将数据提交到<code>url</code>后面</p>
<p>POST请求会将数据提交到<code>Nework</code>里面的请求头里面</p>
</li>
<li><p>GET请求对数据大小有限制</p>
<p>POST请求对数据大小没有限制</p>
</li>
<li><p>GET请求用于提交非敏感数据和小数据</p>
<p>POST请求用于提交敏感数据和大数据</p>
</li>
</ol>
<blockquote>
<p>上传文件</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;03-post-file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;upFile&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;上传&quot;&gt;&lt;br&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    print_r($_FILES);</span><br><span class="line">	//1.获取文件上传对应的字典（对象）</span><br><span class="line">	$fileInfo = $_FILES[&quot;upFile&quot;];</span><br><span class="line">	//2.获取上传文件的名称</span><br><span class="line">	$fileName = $fileInfo[&quot;name&quot;];</span><br><span class="line">	//3.获取上传文件保存的临时路径</span><br><span class="line">	$filePath = $fileInfo[&quot;tmp_name&quot;];</span><br><span class="line">//4.移动文件move_uploaded_file(旧路径,新路径加上传的文件名称); php中的字符串拼接用.</span><br><span class="line">move_uploaded_file($filePath,destination:&quot;./source/&quot;.$fileName);</span><br><span class="line">	</span><br><span class="line">    ?&gt;</span><br></pre></td></tr></table></figure>

<p>注意：上传文件一般用POST提交</p>
<p>必须指定该属性<code>enctype=&quot;multipart/form-data&quot;</code></p>
<p>上传的文件在php中可以通过$_FILES获取，文件默认会上传到一个临时目录，接收完毕之后会自动删除</p>
<h3 id="GET基本使用"><a href="#GET基本使用" class="headerlink" title="GET基本使用"></a>GET基本使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个异步对象</span></span><br><span class="line">    <span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">//2.设置请求方式和请求地址</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    method:请求的类型：GET 或者 POST</span></span><br><span class="line"><span class="comment">    url: 文件在服务器上的位置</span></span><br><span class="line"><span class="comment">    async: true(异步) 或 false(同步)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;04-ajax-get.php?t=&quot;</span>+(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()),<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//3.发送请求</span></span><br><span class="line">    xmlhttp.send();</span><br><span class="line">    <span class="comment">//4.监听状态的变化</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	0:请求未初始化</span></span><br><span class="line"><span class="comment">	1:服务器连接已建立</span></span><br><span class="line"><span class="comment">	2:请求已接收 </span></span><br><span class="line"><span class="comment">	3:请求处理中</span></span><br><span class="line"><span class="comment">	4:请求已完成，且响应已就绪</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params">ev1</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//判断是否请求成功</span></span><br><span class="line">        <span class="keyword">if</span>(xmlhttp.readyState === <span class="number">4</span>)&#123;</span><br><span class="line">        <span class="comment">//5.处理返回的结果</span></span><br><span class="line">            		<span class="comment">//判断http状态码，可以判断输入的地址是否正确</span></span><br><span class="line">                    <span class="keyword">if</span>(xmlhttp.status &gt;= <span class="number">200</span> &amp;&amp; xmlhttp.status &lt;<span class="number">300</span> ||xmlhttp.atatus === <span class="number">304</span>)&#123;</span><br><span class="line">        				<span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">            			<span class="comment">//responseText获得字符串形式的服务器返回的响应式数据 </span></span><br><span class="line">                        <span class="comment">//responseXML获得XML形式的响应数据</span></span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="POST基本使用"><a href="#POST基本使用" class="headerlink" title="POST基本使用"></a>POST基本使用</h3><p><code> xmlhttp.open(&quot;POST&quot;,&quot;04-ajax-get.php?t=&quot;+(new Date().getTime()),true);</code></p>
<p>传递参数的POST:</p>
<p><strong>注意点：必须在open和send方法之间加入<code>xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.open(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;04-ajax-get.php&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">xmlhttp.setRequestHeader(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">xml.send(<span class="string">&quot;userName=zs&amp;userPwd=111&quot;</span>);</span><br></pre></td></tr></table></figure>



<blockquote>
<p>jQurey+Ajax</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">ev1</span>)</span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>:<span class="string">&quot;some.php&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>:<span class="string">&quot;name=John&amp;location=Boston&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">            slert(msg);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params">xhr</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//错误则显示状态码</span></span><br><span class="line">        alert(xhr.status); </span><br><span class="line">    &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><ul>
<li><p>书写XML代码</p>
<p>必须有根标签</p>
<p>标签名可以自定义</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;person&gt;</span><br><span class="line">	&lt;name&gt;xxxx&lt;/name&gt;</span><br><span class="line">	&lt;age&gt;11&lt;/age&gt;</span><br><span class="line">&lt;/person&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>在PHP中获取XML文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//执行结果中有中文，必须在php文件顶部设置</span></span><br><span class="line"><span class="comment">//header(&quot;content-type:text/html;charset=utf-8&quot;);</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//如果PHP中需要返回XML数据，也必须在PHP文件顶部设置</span></span><br><span class="line"><span class="comment">//header(string:&quot;content-type:text/xml;charset=utf-8&quot;);</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    header(<span class="keyword">string</span>:<span class="string">&quot;content-type:text/xml;charset=utf-8&quot;</span>);</span><br><span class="line">    file-get-contents(filename:<span class="string">&quot;info.xml&quot;</span>)</span><br><span class="line">    </span><br></pre></td></tr></table></figure></li>
<li><p>在前端中获得后台返回的XML</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> res = xhr.responseXML;</span><br><span class="line"><span class="comment">//获得XML标签中的值</span></span><br><span class="line"><span class="keyword">var</span> name = res.querySelector(<span class="string">&quot;name&quot;</span>).innerHTML;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(filename:<span class="string">&quot;name.txt&quot;</span>)</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/01/axios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ladyfish">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/01/axios/" class="post-title-link" itemprop="url">Axios</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-08-01 12:45:18" itemprop="dateCreated datePublished" datetime="2020-08-01T12:45:18+08:00">2020-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-11-22 17:14:34" itemprop="dateModified" datetime="2023-11-22T17:14:34+08:00">2023-11-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>封装axios</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.创建axios的实例</span></span><br><span class="line">  <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;http://123.207.32.32:8000&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span></span><br><span class="line">      <span class="comment">//超时时间</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.axios的拦截器</span></span><br><span class="line">  <span class="comment">// 2.1.请求拦截的作用：比如发送请求转圈圈的图标</span></span><br><span class="line">  <span class="comment">//记得把拦截的东西返回！！！</span></span><br><span class="line">  instance.interceptors.request.use(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// console.log(err);</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.2.响应拦截</span></span><br><span class="line">  instance.interceptors.response.use(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> res.data</span><br><span class="line">  &#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.发送真正的网络请求</span></span><br><span class="line">  <span class="keyword">return</span> instance(config)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>调用axios</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&quot;./request&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getHomeMultidata</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/multidata&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getHomeGoods</span>(<span class="params">type, page</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/data&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      type,</span><br><span class="line">      page</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ladyfish</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
